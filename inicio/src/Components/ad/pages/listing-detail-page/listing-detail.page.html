<ad-top-bar-user></ad-top-bar-user>
<div class="detail-wrap" *ngIf="model as d">
<a class="back" (click)="goBack($event)"><span>← Volver</span></a>

  <header class="head">
    <h1 class="title">{{ d.titulo }}</h1>
    <div class="sub">
      <span class="city">{{ d.ciudad }}</span>
      <span class="dot">•</span>
      <span class="price">{{ d.precioPorNoche | currency:'COP':'symbol-narrow':'1.0-0' }} / noche</span>
      <span class="dot" *ngIf="d.rating">•</span>
      <span class="rating" *ngIf="d.rating">★ {{ d.rating | number:'1.1-1' }} ({{ d.ratingCount || 0 }})</span>
    </div>
  </header>

  <!-- Galería -->
  <section class="gallery">
    <div class="main">
      <img
        [src]="(d.portadaUrl || d.imagenes?.[0]) || 'assets/placeholder.webp'"
        [alt]="d.titulo"
        class="main-img"
        loading="lazy"
      />
    </div>
    <div class="thumbs" *ngIf="d.imagenes?.length">
      <img
        *ngFor="let url of d.imagenes | slice:0:6"
        [src]="url"
        class="thumb"
        [alt]="d.titulo"
        loading="lazy"
        (click)="swap(url)"
      />
    </div>
  </section>

  <div class="content">
    <!-- Col izquierda -->
    <section class="left">
      <h3 class="section">Descripción</h3>
      <p class="desc">
        {{ d.descripcion || 'Alojamiento cómodo y bien ubicado.' }}
      </p>

      <h3 class="section">Servicios</h3>
      <div class="chips" *ngIf="d.servicios?.length; else noserv">
        <span class="chip" *ngFor="let s of d.servicios">{{ s }}</span>
      </div>
      <ng-template #noserv>
        <div class="muted">Sin servicios listados</div>
      </ng-template>

      <div class="meta-cards">
        <div class="meta-card">
          <div class="meta-label">Capacidad</div>
          <div class="meta-value">{{ d.capacidadMaxima || 1 }} huéspedes</div>
        </div>
        <div class="meta-card">
          <div class="meta-label">Tipo</div>
          <div class="meta-value">{{ d.tipoAlojamiento || 'Alojamiento' }}</div>
        </div>
        <div class="meta-card" *ngIf="d.direccion">
          <div class="meta-label">Dirección</div>
          <div class="meta-value">{{ d.direccion }}</div>
        </div>
      </div>

      <h3 class="section">Ubicación</h3>
      <div class="map">
        <!-- placeholder; si luego tienes mapa real, reemplaza por el componente -->
        <img src="assets/map-placeholder.webp" alt="Mapa" />
      </div>

      <h3 class="section">Políticas</h3>
      <ul class="bullets">
        <li>Check-in: 3:00 p. m. · Check-out: 11:00 a. m.</li>
        <li>Cancelación flexible 48 h antes.</li>
        <li>No se permiten fiestas.</li>
      </ul>
    </section>

 <!-- Col derecha: caja de reserva/info -->
<aside class="right">
  <div class="booking">
    <div class="booking-price">
      <span class="num">{{ d.precioPorNoche | currency:'COP':'symbol-narrow':'1.0-0' }}</span>
      <span class="per">/ noche</span>
    </div>

    <div class="booking-rows">
      <div class="row">
        <label>Entrada</label>
        <input type="date" [(ngModel)]="entrada" name="entrada" />
      </div>
      <div class="row">
        <label>Salida</label>
        <input type="date" [(ngModel)]="salida" name="salida" />
      </div>
      <div class="row">
        <label>Huéspedes</label>
        <select [(ngModel)]="huespedes" name="huespedes">
          <option *ngFor="let n of [1,2,3,4,5,6,7,8]" [value]="n">{{ n }}</option>
        </select>
      </div>
    </div>

    <button class="btn-primary" (click)="reservar()" [disabled]="reservando">
      {{ reservando ? 'Reservando...' : 'Reservar' }}
    </button>

    <div class="host" *ngIf="d.anfitrionNombre">
      <div class="host-avatar">{{ d.anfitrionNombre[0] || 'A' }}</div>
      <div class="host-info">
        <div class="host-label">Anfitrión</div>
        <div class="host-name">{{ d.anfitrionNombre }}</div>
      </div>
    </div>
  </div>
</aside>


